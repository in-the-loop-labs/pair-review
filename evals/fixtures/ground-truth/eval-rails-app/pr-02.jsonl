{"id": "02-001", "file": "app/controllers/projects_controller.rb", "line_start": 18, "line_end": 18, "type": "bug", "severity": "medium", "title": "Off-by-one in pagination total pages calculation", "description": "Integer division `total_count / @per_page` truncates the result. For example, 11 records with per_page=10 gives total_pages=1 instead of 2, silently dropping the last page of results. Should use `(total_count / @per_page.to_f).ceil`.", "hint": "Use (total_count / @per_page.to_f).ceil for correct page count"}
{"id": "02-002", "file": "app/controllers/projects_controller.rb", "line_start": 72, "line_end": 72, "type": "bug", "severity": "medium", "title": "Same pagination bug duplicated in archived action", "description": "The archived action has the same integer division bug as the index action: `total_count / @per_page` should be `(total_count / @per_page.to_f).ceil`.", "hint": "Fix in both index and archived actions, or extract pagination to a shared method"}
{"id": "02-003", "file": "config/routes.rb", "line_start": 8, "line_end": 8, "type": "code-style", "severity": "low", "title": "Non-RESTful route definition for archived projects", "description": "The archived projects route is defined as a standalone `get` outside the `resources :projects` block. The conventional RESTful approach nests it as a collection route: `resources :projects do; collection do; get :archived; end; end`.", "hint": "Move inside resources :projects as a collection route"}
{"id": "02-004", "file": "app/models/project.rb", "line_start": 11, "line_end": 14, "type": "improvement", "severity": "low", "title": "Missing validation on description length", "description": "The Project model validates name presence and length but has no length validation on the description field. Since description is a text column with no database-level constraint, users could submit arbitrarily large descriptions causing performance and storage issues.", "hint": "Add validates :description, length: { maximum: 5000 }, allow_blank: true"}
{"id": "02-005", "file": "app/controllers/projects_controller.rb", "line_start": 10, "line_end": 10, "type": "security", "severity": "medium", "title": "Unbounded per_page parameter enables denial-of-service", "description": "The per_page parameter is taken directly from user input with no upper bound. A request with per_page=1000000 would load an enormous result set. Same issue in the archived action at line 66.", "hint": "Clamp: @per_page = [[params[:per_page].to_i, 1].max, 100].min"}
{"id": "02-006", "file": "app/controllers/projects_controller.rb", "line_start": 81, "line_end": 81, "type": "security", "severity": "low", "title": "Unscoped Project.find exposes all projects regardless of ownership", "description": "set_project uses Project.find(params[:id]) which loads any project. Combined with show? returning true for everyone, any authenticated user can view any project. If projects should be private, use policy_scope(Project).find(params[:id]).", "hint": "Use policy_scope(Project).find(params[:id]) for consistent scoping"}
{"id": "02-007", "file": "app/models/project.rb", "line_start": 6, "line_end": 6, "type": "bug", "severity": "medium", "title": "has_many :tasks references non-existent Task model", "description": "The model declares has_many :tasks, dependent: :destroy but no Task model or migration exists yet. This will cause errors if any code touches project.tasks or if dependent: :destroy fires during deletion.", "hint": "Remove the association until the Task model is introduced"}
{"id": "02-008", "file": "app/models/project.rb", "line_start": 21, "line_end": 21, "type": "security", "severity": "low", "title": "LIKE wildcards in user input are not escaped", "description": "The search_by_name scope interpolates the query into a LIKE pattern without escaping LIKE metacharacters (%, _). Users can inject wildcards to craft pathological patterns. Also, ILIKE is PostgreSQL-specific.", "hint": "Use sanitize_sql_like and Arel for portability"}
{"id": "02-009", "file": "app/models/project.rb", "line_start": 17, "line_end": 18, "type": "code-style", "severity": "low", "title": "Redundant scopes duplicate enum-generated methods", "description": "Rails enum automatically generates Project.active and Project.archived scopes. The manually defined scopes on lines 17-18 are identical and shadow the auto-generated ones.", "hint": "Remove manual scope :active and scope :archived â€” the enum provides these"}
