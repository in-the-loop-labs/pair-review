# Pair Review

> Your AI-powered code review partner - Close the feedback loop between you and AI coding agents

## What is Pair Review?

Pair Review is a local web application that transforms how you review code, especially code generated by AI coding agents like Claude Code, Cursor, and others. It helps you provide structured feedback and ensures quality through human oversight.

### Two Core Value Propositions

1. **Tight Feedback Loop for AI Coding Agents**
   - Review AI-generated code with clarity and precision
   - Provide structured feedback in markdown format
   - Copy and paste feedback directly back to your coding agent
   - Create a continuous improvement cycle where you stay in control

2. **AI-Assisted Human Review Partner**
   - Get AI-powered suggestions to accelerate your reviews
   - Highlight potential issues and noteworthy code patterns
   - You make the final decisions - adopt, edit, or discard AI suggestions
   - Add your own comments alongside AI insights

## Why Pair Review?

- **Local-First**: All data and processing happens on your machine - no cloud dependencies
- **GitHub-Familiar UI**: Interface feels instantly familiar to GitHub users
- **Human-in-the-Loop**: AI suggests, you decide
- **Multiple AI Providers**: Support for Claude, Gemini, and Codex
- **Progressive**: Start simple with manual review, add AI analysis when you need it

## Quick Start

### Installation

```bash
npx pair-review <PR-number-or-URL>
```

That's it! Pair Review will:
1. Check out the PR branch locally (using git worktrees)
2. Open the web UI in your browser
3. Show you a familiar diff view

### Review a Pull Request

```bash
# By PR number (in a GitHub repo)
npx pair-review 123

# By full GitHub URL
npx pair-review https://github.com/owner/repo/pull/123

# Review local uncommitted changes
npx pair-review --local
```

### Basic Workflow

1. **Review the diff** - See all file changes in a familiar GitHub-like interface
2. **Optional: Trigger AI analysis** - Get 3-level AI insights:
   - Level 1: Issues in changed lines only
   - Level 2: Consistency within file context
   - Level 3: Architectural consistency across codebase
3. **Add comments** - Adopt AI suggestions or write your own
4. **Export feedback** - Copy as markdown to paste back to your coding agent
5. **Submit review** - Post to GitHub with approval status (or keep it local)

## Configuration

On first run, Pair Review creates `~/.pair-review/config.json`:

```json
{
  "github_token": "ghp_your_token_here",
  "port": 3000,
  "theme": "light"
}
```

### GitHub Token

Create a Personal Access Token (PAT) with these scopes:
- `repo` (full control of private repositories)
- `read:org` (if reviewing organization repos)

[Create token on GitHub](https://github.com/settings/tokens/new)

### AI Provider Configuration

Pair Review integrates with AI providers via their CLI tools:

- **Claude**: Uses `claude -p` (SDK mode) for programmatic output
- **Gemini**: Uses Gemini CLI
- **Codex**: Uses Codex CLI

You can select your preferred provider and model in the repository settings UI.

## Features

### Three-Level AI Analysis

Pair Review's AI analysis system examines your code changes at increasing levels of context:

- **Level 1 - Isolation**: Analyzes only the changed lines for bugs and issues
- **Level 2 - File Context**: Checks consistency within the entire file
- **Level 3 - Codebase Context**: Validates architectural patterns across the codebase

This progressive approach keeps analysis focused while catching issues at every scope.

### Review Feedback Export

The killer feature for AI coding agent workflows:

1. Add comments during your review (manual or AI-assisted)
2. Click "Preview Review" to see formatted markdown
3. Copy the markdown
4. Paste into your coding agent's chat
5. Agent iterates based on your feedback

The markdown includes file paths, line numbers, and your comments - everything the agent needs to understand and act on your feedback.

### Inline Comments

- Add comments directly on specific lines
- See all comments in context with the diff
- Edit or discard AI suggestions before finalizing
- Comments include file and line number for precision

### Local Mode

Review unstaged, uncommitted changes before creating a PR:

```bash
npx pair-review --local
```

Perfect for:
- Self-review before committing
- Getting AI feedback on work-in-progress
- Iterating with a coding agent on local changes
- Reviewing only the unstaged files that are still changing

## Development

### Prerequisites

- Node.js 16.0.0 or higher
- Git
- SQLite3

### Running Locally

```bash
# Install dependencies
npm install

# Run tests
npm test

# Run tests in watch mode
npm run test:watch

# Run E2E tests
npm run test:e2e

# Run E2E tests with visible browser
npm run test:e2e:headed

# Start development server
npm run dev
```

### Architecture

- **Backend**: Node.js + Express
- **Frontend**: Vanilla JavaScript (no framework)
- **Database**: SQLite for local storage
- **AI Integration**: CLI-based adapter pattern for multiple providers
- **Git**: Uses git worktrees for clean PR checkout

## Use Cases

### 1. Reviewing AI-Generated Code

You're working with Claude Code on a new feature:

1. Claude generates code changes
2. Run `npx pair-review --local` to review
3. Add comments on issues or improvements needed
4. Copy the markdown feedback
5. Paste back to Claude: "Address my review feedback: [paste]"
6. Claude iterates based on your comments
7. Repeat until satisfied

### 2. Team Pull Request Review

Standard GitHub PR review workflow:

1. Run `npx pair-review <PR-URL>`
2. Optional: Trigger AI analysis for initial insights
3. Review code, adopt useful AI suggestions
4. Add your own expert comments
5. Submit review to GitHub with approval status

### 3. Self-Review Before Committing

Before creating a PR:

1. Make local changes
2. Run `npx pair-review --local`
3. Review your own changes (with or without AI)
4. Catch issues early
5. Commit with confidence

## FAQ

**Q: Does my code get sent to the cloud?**
A: No. All processing happens locally. AI providers are invoked via their local CLI tools.

**Q: Do I need to use AI analysis?**
A: No. Pair Review works great as a local review UI without AI. Trigger analysis only when you want it.

**Q: Which AI provider should I use?**
A: Any that you have configured locally. Claude excels at code review, but try different providers to see what works best for you.

**Q: Can I use this for non-GitHub repos?**
A: Local mode (`--local`) works with any git repository. PR review mode requires GitHub.

**Q: How do I give feedback to a coding agent?**
A: Add comments during review, click "Preview Review", copy the markdown, and paste it into your coding agent's chat interface.

## Contributing

Contributions welcome! Please:

1. Check existing issues or create a new one
2. Fork the repository
3. Create a feature branch
4. Write tests for changes, especially bug fixes
5. Submit a pull request

## License

MIT License - see LICENSE file for details

## Acknowledgments

Built with:
- [Express](https://expressjs.com/) - Web server
- [Octokit](https://github.com/octokit/rest.js) - GitHub API
- [simple-git](https://github.com/steveukx/git-js) - Git operations
- [Playwright](https://playwright.dev/) - E2E testing
- [Vitest](https://vitest.dev/) - Unit testing

---

**Start reviewing better code today:**

```bash
npx pair-review <PR-number-or-URL>
```
