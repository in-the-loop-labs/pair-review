{
  "meta": {
    "baseline": "level3/balanced",
    "baselineHash": "2ad77cb7",
    "targetModel": "gemini-2.5-pro",
    "optimizerModel": "gemini-3-pro-preview",
    "timestamp": "2026-01-18T16:09:21.054Z"
  },
  "delta": {
    "sectionOrder": [
      "role",
      "level-header",
      "pr-context",
      "custom-instructions",
      "line-number-guidance",
      "generated-files",
      "changed-files",
      "available-commands",
      "analysis-strategy",
      "output-schema",
      "logic-rules"
    ],
    "overrides": {
      "level-header": "# Level 3 Review: Codebase Impact & Integration",
      "available-commands": "## Available Tools (READ-ONLY)\nYou have strict READ-ONLY access to investigate the codebase. You MUST NOT modify files.\n- `find . -name \"pattern\"`: Locate test files or dependencies.\n- `grep -r \"pattern\"`: Search for usage patterns or function calls.\n- `cat -n <file>`: View file content with line numbers (essential for context).\n- `ls`, `tree`: Explore directory structure.\n\n**Usage Strategy:**\nUse these tools effectively to validate your assumptions. If you suspect a breaking change, grep for usages. If you suspect missing tests, find the test file."
    },
    "removedSections": [
      "purpose",
      "analysis-process",
      "focus-areas",
      "diff-instructions",
      "file-level-guidance",
      "guidelines"
    ],
    "addedSections": [
      {
        "name": "analysis-strategy",
        "content": "## Analysis Objectives\nPerform a deep analysis of how the changes above relate to the broader system. Do not perform a generic review; focus on the *impact* of these specific changes.\n\n**1. Dependency & Integration**\n- Identify files referencing or referenced by the changed files.\n- Verify if API contracts (public methods, props, endpoints) are preserved.\n- Check for broken cross-file dependencies.\n\n**2. Architecture & Patterns**\n- Ensure changes align with existing project patterns (naming, structure, error handling).\n- Detect if architectural boundaries are violated.\n\n**3. Quality Assurance**\n- **Tests:** Are there accompanying tests? Do they cover the new logic?\n- **Docs:** Do public API changes have corresponding documentation updates?\n- **Performance/Security:** Do these changes introduce bottlenecks or vulnerabilities in connected components?",
        "locked": false,
        "required": true,
        "optional": false
      },
      {
        "name": "logic-rules",
        "content": "## Critical Logic & Guidelines\n\n**1. Line Number Logic (`old_or_new`)**\nStrictly follow this algorithm to determine the column:\n- IF the line starts with `[-]` (deleted): Value is **\"OLD\"**.\n- ELSE (starts with `[+]` or space/context): Value is **\"NEW\"**.\n*Note: Context lines exist in both versions; always attribute them to \"NEW\".*\n\n**2. Suggestion Scope**\n- **Line-Level (Preferred):** Use `suggestions` array. Anchor to specific lines whenever possible.\n- **File-Level:** Use `fileLevelSuggestions` ONLY for issues applying to the entire file (e.g., missing tests, architectural misplacement, doc gaps).\n\n**3. Confidence Calibration**\n- **0.8 - 1.0 (High):** Clear bugs, breaking changes, or obvious pattern violations. (Include these).\n- **0.5 - 0.7 (Medium):** Likely issues or strong suggestions based on partial context.\n- **< 0.5 (Low):** Omit unless critical security concern.",
        "locked": false,
        "required": true,
        "optional": false
      }
    ]
  },
  "changes": [
    {
      "section": "role",
      "type": "unchanged",
      "rationale": "Kept as simple variable insertion; content depends on runtime variable."
    },
    {
      "section": "pr-context",
      "type": "unchanged",
      "rationale": "Locked section."
    },
    {
      "section": "custom-instructions",
      "type": "unchanged",
      "rationale": "Preserved optional user overrides."
    },
    {
      "section": "level-header",
      "type": "modified",
      "rationale": "Shortened title for punchier context setting."
    },
    {
      "section": "line-number-guidance",
      "type": "unchanged",
      "rationale": "Preserved variable insertion."
    },
    {
      "section": "generated-files",
      "type": "unchanged",
      "rationale": "Kept optional context."
    },
    {
      "section": "changed-files",
      "type": "unchanged",
      "rationale": "Locked section."
    },
    {
      "section": "available-commands",
      "type": "reordered",
      "rationale": "Moved up before analysis instructions. Defines capabilities before defining the task. Clarified usage strategy."
    },
    {
      "section": "purpose",
      "type": "removed",
      "rationale": "Merged into 'analysis-strategy' to reduce verbosity and section hopping."
    },
    {
      "section": "analysis-process",
      "type": "modified",
      "rationale": "Renamed to 'analysis-strategy'. Merged with 'purpose' and 'focus-areas' to provide a single, unified instruction block for the model to follow."
    },
    {
      "section": "focus-areas",
      "type": "removed",
      "rationale": "Content merged into 'analysis-strategy' for better flow and token efficiency."
    },
    {
      "section": "output-schema",
      "type": "unchanged",
      "rationale": "Locked section."
    },
    {
      "section": "diff-instructions",
      "type": "modified",
      "rationale": "Renamed to 'logic-rules'. Converted text-heavy explanation into a strict IF/ELSE algorithm for 'old_or_new' field, which reduces hallucination in logic-capable models."
    },
    {
      "section": "file-level-guidance",
      "type": "removed",
      "rationale": "Redundant. Core rules merged into 'logic-rules' under 'Suggestion Scope'."
    },
    {
      "section": "guidelines",
      "type": "removed",
      "rationale": "Merged into 'logic-rules' to keep all constraints (confidence, JSON format, line logic) in one final checklist section."
    }
  ]
}